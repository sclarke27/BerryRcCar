<!-- Dynamic recon: Creating gauge components -->
<style>
	.value {
		font-family: Digital7;
		color: black;
	}
	.quilt {
		position: relative;
	}
	.card{
		border: solid 1px rgba(100,100,100,0.3);
		box-shadow: 0px 0px 2px 1px rgba(100,100,100,0.1);
	}
</style>
<div class="statusHeader">
	<script type="text/recon">
		@div {
			host: '{{fullSwimUrl}}'
			node: 'botState'
			botName:  @link(lane: 'name', type: value)
			@text([{$eager($botName#0)} Sensor Dash])
		}
	</script>
</div>
<script type="text/recon">
@div {
	blocks: {
		block1: {
			card1: {
				node: '/sensor/centerDistance'
				title: 'Center Ping Sensor'
				subtitle: 'Distance'
				sensorDialColor: '#3333ff'
				sensorTextColor: '#000000'
				cardPlacement: 'top-left'
				gaugeMax: 12000
			}	
			card2: {
				node: '/sensor/rearDistance'
				title: 'Rear Ping Sensor'
				subtitle: 'Distance'
				sensorDialColor: '#3333ff'
				sensorTextColor: '#000000'
				cardPlacement: 'top-right'
				gaugeMax: 12000
			}	
			card3: {
				node: '/sensor/leftDistance'
				title: 'Left Ping Sensor'
				subtitle: 'Distance'
				sensorDialColor: '#3333ff'
				sensorTextColor: '#000000'
				cardPlacement: 'middle-left'
				gaugeMax: 12000
			}

			card4: {
				node: '/sensor/rightDistance'
				title: 'Right Ping Sensor'
				subtitle: 'Distance'
				sensorDialColor: '#3333ff'
				sensorTextColor: '#000000'
				cardPlacement: 'middle-right'
				gaugeMax: 12000
			}

						
		}

		block2: {
			steeringCard: {
				node: '/sensor/steeringRadio'
				title: 'Radio'
				subtitle: 'Steering Radio'
				sensorDialColor: '#cc0000'
				sensorTextColor: '#000000'
				cardPlacement: 'top-left'
				gaugeMax: 180
			}
			accelXCard: {
				node: '/sensor/accelX'
				title: 'MPU-92/65'
				subtitle: 'X Acceleration'
				sensorDialColor: '#550000'
				sensorTextColor: '#000000'
				cardPlacement: 'top-right'
				gaugeMax: 3000
			}	
			throttleCard: {
				node: '/sensor/throttleRadio'
				title: 'Radio'
				subtitle: 'Throttle Radio'
				sensorDialColor: '#cc0000'
				sensorTextColor: '#000000'
				cardPlacement: 'middle-left'
				gaugeMax: 180
			}
			magXCard: {
				node: '/sensor/magX'
				title: 'MPU-92/65'
				subtitle: 'Magnetometer X'
				sensorDialColor: '#00ff00'
				sensorTextColor: '#000000'
				cardPlacement: 'middle-right'
				gaugeMax: 500
			}

			
		}		

		block3: {

			accelYCard: {
				node: '/sensor/accelY'
				title: 'MPU-92/65'
				subtitle: 'Y Acceleration'
				sensorDialColor: '#550000'
				sensorTextColor: '#000000'
				cardPlacement: 'top-left'
				gaugeMax: 3000
			}	

			accelZCard: {
				node: '/sensor/accelZ'
				title: 'MPU-92/65'
				subtitle: 'Z Acceleration'
				sensorDialColor: '#550000'
				sensorTextColor: '#000000'
				cardPlacement: 'top-right'
				gaugeMax: 3000
			}	
			magYCard: {
				node: '/sensor/magY'
				title: 'MPU-92/65'
				subtitle: 'Magnetometer Y'
				sensorDialColor: '#00ff00'
				sensorTextColor: '#000000'
				cardPlacement: 'middle-left'
				gaugeMax: 500
			}	

			magZCard: {
				node: '/sensor/magZ'
				title: 'MPU-92/65'
				subtitle: 'Magnetometer Z'
				sensorDialColor: '#00ff00'
				sensorTextColor: '#000000'
				cardPlacement: 'middle-right'
				gaugeMax: 500
			}		

		
		}		
		block4: {
			card1: {
				node: '/sensor/headDistance'
				title: 'Head Ping Sensor'
				subtitle: 'Distance'
				sensorDialColor: '#3333ff'
				sensorTextColor: '#000000'
				cardPlacement: 'top-left'
				gaugeMax: 12000
			}		
			card2: {
				node: '/sensor/compass1'
				title: 'HM55B'
				subtitle: 'Compass'
				sensorDialColor: '#cc00cc'
				sensorTextColor: '#000000'
				cardPlacement: 'top-right'
				gaugeMax: 360
			} 			
			card3: {
				node: '/sensor/temperature2'
				title: 'BMP180'
				subtitle: 'temperature C'
				sensorDialColor: '#00cc00'
				sensorTextColor: '#000000'
				cardPlacement: 'bottom-left'
				gaugeMax: 150
			}			
		}

		block5: {		
			card3: {
				node: '/sensor/tiltRadio'
				title: 'Radio'
				subtitle: 'Tilt Radio'
				sensorDialColor: '#cc0000'
				sensorTextColor: '#000000'
				cardPlacement: 'top-left'
				gaugeMax: 180
			}

			gyroXcard: {
				node: '/sensor/gyroX'
				title: 'MPU-92/65'
				subtitle: 'Gyro X'
				sensorDialColor: '#0000ff'
				sensorTextColor: '#000000'
				cardPlacement: 'top-right'
				gaugeMax: 1000
			}			

			panRadio: {
				node: '/sensor/panRadio'
				title: 'Radio'
				subtitle: 'Pan Radio'
				sensorDialColor: '#cc0000'
				sensorTextColor: '#000000'
				cardPlacement: 'middle-left'
				gaugeMax: 180
			}				

			
			phoneMagX: {
				node: '/sensor/phoneMagX'
				title: 'Phone'
				subtitle: 'Magnetometer X'
				sensorDialColor: '#00ff00'
				sensorTextColor: '#000000'
				cardPlacement: 'middle-right'
				gaugeMax: 180
			}

		}
		block6: {
			card2: {
				node: '/sensor/gyroY'
				title: 'MPU-92/65'
				subtitle: 'Gyro Y'
				sensorDialColor: '#0000ff'
				sensorTextColor: '#000000'
				cardPlacement: 'top-left'
				gaugeMax: 1000
			}

			card3: {
				node: '/sensor/gyroZ'
				title: 'MPU-92/65'
				subtitle: 'Gyro Z'
				sensorDialColor: '#0000ff'
				sensorTextColor: '#000000'
				cardPlacement: 'top-right'
				gaugeMax: 1000
			}				


			card5: {
				node: '/sensor/phoneMagY'
				title: 'Phone'
				subtitle: 'Magnetometer Y'
				sensorDialColor: '#00ff00'
				sensorTextColor: '#000000'
				cardPlacement: 'bottom-left'
				gaugeMax: 360
			}

			card6: {
				node: '/sensor/phoneMagZ'
				title: 'Phone'
				subtitle: 'Magnetometer Z'
				sensorDialColor: '#00ff00'
				sensorTextColor: '#000000'
				cardPlacement: 'bottom-right'
				gaugeMax: 90
			}
	
		}									 
	}	
	@quilt {
		host: '{{fullSwimUrl}}'
		{{!-- host: 'ws://127.0.0.1:5620' --}}

		blockAspectRatio: 1
		transition: @transition(0, linear)
		blockMarginScale: 10

		@each(blockKey: $blocks.*:) {
			@block {
				@each(cardKey: $blocks.($blockKey).*:) {
					@card {
						backgroundColor: 'rgba(200,200,200,0.0)'
						currentBlock: @let($blocks.($blockKey).($cardKey))
						sensorDialColor: $currentBlock.sensorDialColor
						sensorTextColor: $currentBlock.sensorTextColor
						title: @text($eager($currentBlock.title))
						subtitle: @text($eager($currentBlock.subtitle))
						subtitleColor: $currentBlock.sensorDialColor
						node: $currentBlock.node
						placement: $currentBlock.cardPlacement
						body: @div{
								style: {
									display: 'flex'
									flex-direction: 'column'
									width: '100%'
								}
								@div {
									style: {
										display: 'flex'
										flex-grow: 1
										max-height: '60%'
									}
									@gauge {
										id: gauge

										# Gauge Values
										linkData: @link(lane: 'latest', type: value)
										meter: $round($linkData#0)/$currentBlock.gaugeMax
										value: @text([{ $round($eager($linkData#0)) || 0}])

										# Gauge Style
										innerRadius: 60 @pct
										dialCornerRadius: 5 @pct
										faceColor: 'rgba(200, 200, 200, 0.15)'
										dialColor: $currentBlock.sensorDialColor
										valueColor: $currentBlock.sensorTextColor
										valueWeight: 400
										valueSize: 80 @pct
									}
								}
								@div {
									style: {
										display: 'flex'
										flex-grow: 1
										max-height: '405%'
									}
									@chart {
										id: chart
										@plot(type: area) {
											historyLink: @link(lane: 'history', type: map)
											areaFill: $currentBlock.sensorDialColor
											@each(t: $historyLink.*:) {
												key: $t
												@plotPoint {
													v: @let($historyLink.($t))
													x: $t
													y: $round($eager($v/10))
													dy: 0
												}
											}
										}

										top: {
											gutter: '50px'
										}
										right: {
											gutter: '0px'
										}
										bottom: @axis(type: time) {
											gutter: '0px'
											hidden: true
										}
										left: @axis(type: linear) {
											gutter: '0px'
											hidden: true
										}

										domainBoundLeft: true
										domainBoundRight: true
										domainPaddingTop: 1
										domainPaddingBottom: 1
									}	
								}			
							}
					}
				}
				
			}
		}
	}
}
</script>
